{% extends "base.html" %}
{% load i18n %}

{% block title %}{{device.name}}{% endblock %}

{% block header %}
Device: {{device.name}}
{% endblock %}

{% block pullright %}
{% if device.archived == None %}
  <a href="{% url 'device-delete' device.id %}" class="button alert right small" style="margin-left:10px">Delete</a>
  <a href="{% url 'device-archive' device.id %}" class="button alert right small" style="margin-left:10px">Archive</a>
<a href="{% url 'device-add-copy' device.id %}" class="button small right" style="margin-left:10px">Create Copy</a>
  <a href="{% url 'device-edit' device.id %}" class="button small right" style="margin-left:10px">Edit</a>
  {% if device.currentlending != None %}
    <a href="{% url 'device-return' device.id %}" class="button success right small"style="margin-left:10px">Mark as returned</a>
  {% else %}
    <a href="{% url 'device-lend' device.id %}" class="button success right small"style="margin-left:10px">Mark as Lendt</a>
  {% endif %}
{% else %}
  <a href="{% url 'device-archive' device.id %}" class="button alert right small" style="margin-left:10px">Unarchive</a>
{% endif %}
{% endblock %}

{% block content %}
<div class="row">
  <div class="small-12 large-4 columns">
    <table>
      <tbody>
        <tr><td>Buildnumber</td><td>{{device.buildnumber}}</td></tr>
        <tr><td>Serialnumber</td><td>{{device.serialnumber}}</td></tr>
        <tr><td>MAC-Address</td><td>{{device.macaddress}}</td></tr>
        <tr><td>Devicetype</td><td>{{device.devicetype}}</td></tr>
        <tr><td>Manufacturer</td><td>{{device.manufacturer}}</td></tr>
        <tr><td>Room</td><td>{{device.room}}</td></tr>
      </tbody>
    </table>
<h4> Current Lending information</h4>
    {% if device.currentlending != None %}
      <table>
      <tbody>
        <tr><td>Lendt to</td><td>{{device.currentlending.owner}}</td></tr>
        <tr><td>Since</td><td>{{device.currentlending.lenddate}}</td></tr>
        <tr><td>Due to</td><td>{{device.currentlending.duedate}}</td></tr>
      </tbody>
    </table>
    {% else %}
    <p>Currently not lent</p>
    {% endif %}

{% if lending_list %}
<h4>Lending history</h4>
    <table width="100%">
  <thead>
    <tr>
      <th>User</th>
      <th>Since</th>
      <th>Duedate</th>
      <th>Returned</th>
    </tr>
  </thead>
  <tbody>
    {% for lending in lending_list %}
    <tr>
      <td>{{lending.owner}}</td>
      <td>{{lending.lenddate}}</td>
      <td>{{lending.duedate}}</td>
      <td>{{lending.returndate}}</td>
    </tr>
     {% endfor %}
  </tbody>
</table>
{% endif %}

    <a href="{% url 'device-history-list' device.pk %}">View edit-history</a>
  </div>
<div class="small-12 large-4 columns">
{{device.description}}
</div>
  <div class="small-12 large-4 columns">
    <ul class="pricing-table">
      <li class="title">IP-Addresses</li>
      {% for address in ipaddress_list %}
        <li class="bullet-item">{{address.address}} <a href="{% url 'device-ipaddress-remove' device.pk address.pk %}" class="close delete right">x</a></li>
      {% endfor %}
      {% if device.archived == None %}
      <li class="cta-button"><form method="post" action="{% url 'device-ipaddress' device.pk %}" style="margin:0px;">{% csrf_token %}
        <div class="row">
      <div class="large-12 columns">
        {{ipaddressform.ipaddresses}}
      </div>
    </div>
        <div class="row"  style="margin-top:10px;">
      <div class="large-12 columns">

        <input type="submit" class ="button small right" value="Assign Addresses">
      </div>
    </div>
    <input type="hidden" name="device" value="{{ device.pk }}" />
      </form></li>
    </ul>
    {% endif %}
  </div>
</div>
{% endblock %}

{% block scriptend %}
$("#id_ipaddresses").select2({
    tokenSeparators: [",", " "]});
{% endblock %}